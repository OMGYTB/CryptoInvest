<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Abonnements - CryptoInvest</title>
    <link rel="stylesheet" href="../css/style.css" />
    <link rel="stylesheet" href="../css/membership.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="shortcut icon" href="../img/logo (2).ico" type="image/x-icon">
</head>

<body data-require-auth>
    <header>
        <nav>
            <div class="logo">
                <h1>Crypto<span>Invest</span></h1>
            </div>
            <div class="burger">
                <span></span>
                <span></span>
                <span></span>
            </div>
            <ul class="nav-links">
                <li><a href="../index.html">Accueil</a></li>
                <li><a href="market.html">Marché</a></li>
                <li><a href="learn.html">Apprendre</a></li>
            </ul>
            <div class="nav-button">
                <a href="login.html" class="login-btn">Connexion</a>
                <a href="signup.html" class="sign-btn">Inscription</a>
            </div>
        </nav>
    </header>

    <section class="membership-section">
        <div class="membership-container">
            <div class="membership-header">
                <h2>Nos Formules d'Abonnement</h2>
                <p>Choisissez la formule qui correspond à vos besoins et accédez à nos formations exclusives sur les cryptomonnaies</p>
            </div>

            <div class="membership-plans">
                <!-- Plan Gratuit -->
                <div class="plan-card">
                    <div class="plan-name">Gratuit</div>
                    <div class="plan-price">0€ <span>/ mois</span></div>
                    <p class="plan-description">Accès limité aux ressources de base</p>
                    <ul class="plan-features">
                        <li><i class="fas fa-check"></i> Accès aux cours débutants</li>
                        <li><i class="fas fa-check"></i> Ressources gratuites</li>
                        <li><i class="fas fa-check"></i> Actualités crypto</li>
                        <li><i class="fas fa-times"></i> Cours intermédiaires</li>
                        <li><i class="fas fa-times"></i> Cours avancés</li>
                        <li><i class="fas fa-times"></i> Support prioritaire</li>
                    </ul>
                    <button class="plan-button current-plan" id="free-plan">Votre plan actuel</button>
                </div>

                <!-- Plan Basic -->
                <div class="plan-card">
                    <div class="plan-name">Basic</div>
                    <div class="plan-price">19.99€ <span>/ mois</span></div>
                    <p class="plan-description">Idéal pour les débutants souhaitant approfondir</p>
                    <ul class="plan-features">
                        <li><i class="fas fa-check"></i> Tout le contenu gratuit</li>
                        <li><i class="fas fa-check"></i> Accès aux cours intermédiaires</li>
                        <li><i class="fas fa-check"></i> Analyses de marché hebdomadaires</li>
                        <li><i class="fas fa-check"></i> Communauté d'entraide</li>
                        <li><i class="fas fa-times"></i> Cours avancés</li>
                        <li><i class="fas fa-times"></i> Support prioritaire</li>
                    </ul>
                    <button class="plan-button primary-button" data-plan="basic" data-price="19.99" data-duration="30">S'abonner</button>
                </div>

                <!-- Plan Premium -->
                <div class="plan-card popular">
                    <div class="popular-badge">Populaire</div>
                    <div class="plan-name">Premium</div>
                    <div class="plan-price">39.99€ <span>/ mois</span></div>
                    <p class="plan-description">Pour les traders sérieux et investisseurs</p>
                    <ul class="plan-features">
                        <li><i class="fas fa-check"></i> Tout le contenu Basic</li>
                        <li><i class="fas fa-check"></i> Accès aux cours avancés</li>
                        <li><i class="fas fa-check"></i> Stratégies de trading exclusives</li>
                        <li><i class="fas fa-check"></i> Webinaires mensuels</li>
                        <li><i class="fas fa-check"></i> Support prioritaire</li>
                        <li><i class="fas fa-check"></i> Analyses techniques personnalisées</li>
                    </ul>
                    <button class="plan-button primary-button" data-plan="premium" data-price="39.99" data-duration="30">S'abonner</button>
                </div>

                <!-- Plan Pro -->
                <div class="plan-card">
                    <div class="plan-name">Pro</div>
                    <div class="plan-price">99.99€ <span>/ mois</span></div>
                    <p class="plan-description">Pour les professionnels et investisseurs sérieux</p>
                    <ul class="plan-features">
                        <li><i class="fas fa-check"></i> Tout le contenu Premium</li>
                        <li><i class="fas fa-check"></i> Accès à toutes les formations</li>
                        <li><i class="fas fa-check"></i> Conseils personnalisés</li>
                        <li><i class="fas fa-check"></i> Sessions privées avec experts</li>
                        <li><i class="fas fa-check"></i> Signaux de trading exclusifs</li>
                        <li><i class="fas fa-check"></i> Accès anticipé aux nouvelles formations</li>
                    </ul>
                    <button class="plan-button primary-button" data-plan="pro" data-price="99.99" data-duration="30">S'abonner</button>
                </div>
            </div>

            <div class="faq-section">
                <div class="membership-header">
                    <h2>Questions Fréquentes</h2>
                </div>
                <div class="faq-container">
                    <div class="faq-item">
                        <div class="faq-question">
                            <h3>Comment fonctionne l'abonnement ?</h3>
                            <i class="fas fa-chevron-down"></i>
                        </div>
                        <div class="faq-answer">
                            <p>Nos abonnements sont mensuels et vous donnent accès à différents niveaux de contenu selon la formule choisie. Vous pouvez changer ou annuler votre abonnement à tout moment depuis votre espace membre.</p>
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <h3>Puis-je changer de formule ?</h3>
                            <i class="fas fa-chevron-down"></i>
                        </div>
                        <div class="faq-answer">
                            <p>Oui, vous pouvez passer à une formule supérieure à tout moment. Si vous souhaitez passer à une formule inférieure, le changement prendra effet à la fin de votre période de facturation en cours.</p>
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <h3>Comment annuler mon abonnement ?</h3>
                            <i class="fas fa-chevron-down"></i>
                        </div>
                        <div class="faq-answer">
                            <p>Vous pouvez annuler votre abonnement à tout moment depuis votre espace membre. Votre accès restera actif jusqu'à la fin de la période de facturation en cours.</p>
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <h3>Les paiements sont-ils sécurisés ?</h3>
                            <i class="fas fa-chevron-down"></i>
                        </div>
                        <div class="faq-answer">
                            <p>Oui, tous nos paiements sont sécurisés et cryptés. Nous n'avons jamais accès à vos informations de carte bancaire complètes, qui sont traitées par notre partenaire de paiement sécurisé.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Modal de paiement -->
    <div class="payment-modal" id="payment-modal">
        <div class="modal-content">
            <div class="close-modal" id="close-modal">
                <i class="fas fa-times"></i>
            </div>
            <h2>Finaliser votre abonnement</h2>
            <p id="plan-summary">Abonnement Premium - 39.99€/mois</p>
            
            <div id="payment-alert"></div>
            
            <form id="payment-form" class="payment-form">
                <div class="form-group">
                    <label for="card-name">Nom sur la carte</label>
                    <input type="text" id="card-name" required>
                </div>
                
                <div class="card-details">
                    <div class="form-group">
                        <label for="card-number">Numéro de carte</label>
                        <input type="text" id="card-number" placeholder="1234 5678 9012 3456" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="card-expiry">Expiration</label>
                        <input type="text" id="card-expiry" placeholder="MM/AA" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="card-cvc">CVC</label>
                        <input type="text" id="card-cvc" placeholder="123" required>
                    </div>
                </div>
                
                <button type="submit" class="plan-button primary-button">Confirmer le paiement</button>
            </form>
        </div>
    </div>

    <footer class="footer">
        <div class="footer-waves">
            <div class="wave" id="wave1"></div>
            <div class="wave" id="wave2"></div>
            <div class="wave" id="wave3"></div>
            <div class="wave" id="wave4"></div>
        </div>
        
        <div class="footer-content">
            <div class="footer-section brand">
                <h2 class="footer-logo">Crypto<span>Invest</span></h2>
                <p class="footer-description">
                    Votre partenaire de confiance pour l'investissement en cryptomonnaies. 
                    Sécurité, transparence et innovation.
                </p>
                <div class="footer-social">
                    <a href="#" class="social-link"><i class="fab fa-twitter"></i></a>
                    <a href="#" class="social-link"><i class="fab fa-discord"></i></a>
                    <a href="#" class="social-link"><i class="fab fa-telegram"></i></a>
                    <a href="#" class="social-link"><i class="fab fa-linkedin"></i></a>
                </div>
            </div>

            <div class="footer-section links">
                <h3>Navigation</h3>
                <ul>
                    <li><a href="market.html">Marché</a></li>
                    <li><a href="learn.html">Formation</a></li>
                    <li><a href="portfolio.html">Portfolio</a></li>
                    <li><a href="news.html">Actualités</a></li>
                </ul>
            </div>

            <div class="footer-section links">
                <h3>Ressources</h3>
                <ul>
                    <li><a href="#">Centre d'aide</a></li>
                    <li><a href="#">Documentation</a></li>
                    <li><a href="#">Blog</a></li>
                    <li><a href="#">API</a></li>
                </ul>
            </div>

            <div class="footer-section contact">
                <h3>Contact</h3>
                <div class="contact-info">
                    <div class="contact-item">
                        <i class="fas fa-envelope"></i>
                        <span>contact@cryptoinvest.com</span>
                    </div>
                    <div class="contact-item">
                        <i class="fas fa-phone"></i>
                        <span>+33 1 23 45 67 89</span>
                    </div>
                    <div class="contact-item">
                        <i class="fas fa-map-marker-alt"></i>
                        <span>Paris, France</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="footer-bottom">
            <div class="footer-bottom-content">
                <p>&copy; 2024 CryptoInvest. Tous droits réservés.</p>
                <div class="footer-bottom-links">
                    <a href="#">Mentions légales</a>
                    <a href="#">Politique de confidentialité</a>
                    <a href="#">Conditions d'utilisation</a>
                </div>
            </div>
        </div>
    </footer>

    <script src="../js/hambuger.js"></script>
    <script src="../js/auth.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Éléments du DOM
            const paymentModal = document.getElementById('payment-modal');
            const closeModal = document.getElementById('close-modal');
            const planButtons = document.querySelectorAll('.plan-button:not(.current-plan)');
            const planSummary = document.getElementById('plan-summary');
            const paymentForm = document.getElementById('payment-form');
            const paymentAlert = document.getElementById('payment-alert');
            const freePlanButton = document.getElementById('free-plan');
            
            // Variables pour stocker les détails du plan sélectionné
            let selectedPlan = '';
            let selectedPrice = 0;
            let selectedDuration = 0;
            
            // Mettre à jour l'affichage du plan actuel
            function updateCurrentPlan() {
                const currentUser = CryptoInvestAuth.getCurrentUser();
                if (!currentUser) return;
                
                const membershipLevel = currentUser.membershipLevel;
                const planButtons = document.querySelectorAll('.plan-button');
                
                planButtons.forEach(button => {
                    const plan = button.getAttribute('data-plan');
                    
                    if (plan === membershipLevel) {
                        button.classList.remove('primary-button');
                        button.classList.add('current-plan');
                        button.textContent = 'Votre plan actuel';
                        button.disabled = true;
                    } else if (button.id === 'free-plan' && membershipLevel !== 'free') {
                        button.classList.remove('current-plan');
                        button.classList.add('secondary-button');
                        button.textContent = 'Rétrograder';
                        button.disabled = false;
                    }
                });
            }
            
            // Ouvrir la modal de paiement
            function openPaymentModal(plan, price, duration) {
                selectedPlan = plan;
                selectedPrice = price;
                selectedDuration = duration;
                
                planSummary.textContent = `Abonnement ${plan.charAt(0).toUpperCase() + plan.slice(1)} - ${price}€/mois`;
                paymentModal.classList.add('active');
            }
            
            // Fermer la modal de paiement
            function closePaymentModal() {
                paymentModal.classList.remove('active');
                paymentForm.reset();
                paymentAlert.style.display = 'none';
            }
            
            // Afficher une alerte
            function showAlert(message, type) {
                paymentAlert.textContent = message;
                paymentAlert.className = type === 'success' ? 'alert-success' : 'alert-error';
                paymentAlert.style.display = 'block';
                
                if (type === 'success') {
                    setTimeout(() => {
                        closePaymentModal();
                        window.location.reload();
                    }, 2000);
                }
            }
            
            // Traiter le paiement
            async function processPayment(e) {
                e.preventDefault();
                
                // Simuler un traitement de paiement
                const cardNumber = document.getElementById('card-number').value;
                const cardExpiry = document.getElementById('card-expiry').value;
                const cardCVC = document.getElementById('card-cvc').value;
                
                // Validation basique
                if (!cardNumber || !cardExpiry || !cardCVC) {
                    showAlert('Veuillez remplir tous les champs', 'error');
                    return;
                }
                
                // Simuler un délai de traitement
                showAlert('Traitement en cours...', 'success');
                
                try {
                    // Simuler un appel API
                    await new Promise(resolve => setTimeout(resolve, 1500));
                    
                    // Mettre à jour l'abonnement de l'utilisateur
                    await CryptoInvestAuth.updateUserMembership(selectedPlan, selectedDuration);
                    
                    showAlert('Paiement réussi ! Votre abonnement a été mis à jour.', 'success');
                } catch (error) {
                    showAlert(error.message || 'Erreur lors du traitement du paiement', 'error');
                }
            }
            
            // Gérer le clic sur le plan gratuit
            if (freePlanButton) {
                freePlanButton.addEventListener('click', async function() {
                    if (this.classList.contains('current-plan')) return;
                    
                    try {
                        await CryptoInvestAuth.updateUserMembership('free', 0);
                        window.location.reload();
                    } catch (error) {
                        console.error('Erreur:', error);
                    }
                });
            }
            
            // Ajouter les écouteurs d'événements
            planButtons.forEach(button => {
                if (button.classList.contains('primary-button')) {
                    button.addEventListener('click', function() {
                        const plan = this.getAttribute('data-plan');
                        const price = this.getAttribute('data-price');
                        const duration = this.getAttribute('data-duration');
                        
                        openPaymentModal(plan, price, duration);
                    });
                }
            });
            
            closeModal.addEventListener('click', closePaymentModal);
            paymentForm.addEventListener('submit', processPayment);
            
            // Fermer la modal si on clique en dehors
            window.addEventListener('click', function(e) {
                if (e.target === paymentModal) {
                    closePaymentModal();
                }
            });
            
            // Gérer les FAQ
            const faqItems = document.querySelectorAll('.faq-item');
            
            faqItems.forEach(item => {
                const question = item.querySelector('.faq-question');
                
                question.addEventListener('click', () => {
                    const isActive = item.classList.contains('active');
                    
                    // Fermer toutes les autres réponses
                    faqItems.forEach(otherItem => {
                        if (otherItem !== item) {
                            otherItem.classList.remove('active');
                            otherItem.querySelector('.faq-question i').style.transform = 'rotate(0deg)';
                        }
                    });
                    
                    // Basculer l'état actif de la question cliquée
                    item.classList.toggle('active');
                    
                    // Animation de la flèche
                    const icon = question.querySelector('i');
                    icon.style.transform = isActive ? 'rotate(0deg)' : 'rotate(180deg)';
                });
            });
            
            // Initialiser l'affichage du plan actuel
            updateCurrentPlan();
        });
    </script>
</body>

</html>